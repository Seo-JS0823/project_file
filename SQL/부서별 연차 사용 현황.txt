SELECT 
    D.DEPARTMENT_NAME,
    M.NAME AS MANAGER_NAME,
    SUM(A.USE_LEAVE_CNT) AS USED_LEAVE,
    SUM(A.OVER_LEAVE_CNT) AS OVER_LEAVE
FROM PROJECT1.ANNUALLEAVE A
JOIN PROJECT1.EMPLOYEES E 
  ON A.EMPLOYEE_ID = E.EMPLOYEE_ID
JOIN PROJECT1.DEPARTMENTS D 
  ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
LEFT JOIN PROJECT1.EMPLOYEES M 
  ON D.MANAGER_ID = M.EMPLOYEE_ID
WHERE A.YEAR = EXTRACT(YEAR FROM SYSDATE)
GROUP BY D.DEPARTMENT_NAME, M.NAME
ORDER BY USED_LEAVE DESC;