SELECT 
    E.EMPLOYEE_ID,
    E.NAME,
    D.DEPARTMENT_NAME,
    M.NAME AS MANAGER_NAME,
    H.LEAVE_START_DATE,
    H.LEAVE_END_DATE,
    H.ANNUAL_DAYS,
    H.CONTENT
FROM PROJECT1.LEAVE_HISTORY H
JOIN PROJECT1.EMPLOYEES E 
  ON H.EMPLOYEE_ID = E.EMPLOYEE_ID
JOIN PROJECT1.DEPARTMENTS D 
  ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
LEFT JOIN PROJECT1.EMPLOYEES M 
  ON D.MANAGER_ID = M.EMPLOYEE_ID
ORDER BY H.LEAVE_START_DATE DESC;