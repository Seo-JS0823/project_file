SELECT 
    M.NAME AS MANAGER_NAME,
    D.DEPARTMENT_NAME,
    E.EMPLOYEE_ID,
    E.NAME AS EMP_NAME,
    A.CURRENTDATE,
    A.ATTE_START,
    A.ATTE_END,
    NVL(L.STATUS, 0) AS LATE_STATUS,
    NVL(H.ANNUAL_DAYS, 0) AS LEAVE_USED
FROM PROJECT1.EMPLOYEES E
JOIN PROJECT1.DEPARTMENTS D 
  ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN PROJECT1.EMPLOYEES M 
  ON D.MANAGER_ID = M.EMPLOYEE_ID
LEFT JOIN PROJECT1.ATTENDANCE_RECORD A 
  ON E.EMPLOYEE_ID = A.EMPLOYEE_ID
LEFT JOIN PROJECT1.LATENESS L 
  ON E.EMPLOYEE_ID = L.EMPLOYEE_ID
 AND A.CURRENTDATE = L.NESS_DATE
LEFT JOIN PROJECT1.LEAVE_HISTORY H 
  ON E.EMPLOYEE_ID = H.EMPLOYEE_ID
 AND A.CURRENTDATE BETWEEN H.LEAVE_START_DATE AND H.LEAVE_END_DATE
WHERE M.EMPLOYEE_ID = 'MNG001'
ORDER BY A.CURRENTDATE;